# ğŸ” YouTube Subtitle MCP - Streamable HTTP è¯Šæ–­æŠ¥å‘Š

ç”Ÿæˆæ—¶é—´: 2025-11-25

## âœ… æµ‹è¯•ç»“æœæ€»ç»“

**æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼ä½ çš„Streamable HTTPå®ç°å®Œå…¨ç¬¦åˆMCPæ ‡å‡†ã€‚**

---

## ğŸ“Š æµ‹è¯•è¯¦æƒ…

### 1. âœ… æœåŠ¡å™¨å¯åŠ¨æµ‹è¯•

**çŠ¶æ€**: âœ… æˆåŠŸ

- HTTPæœåŠ¡å™¨æˆåŠŸåœ¨ç«¯å£3000å¯åŠ¨
- Health endpointæ­£å¸¸å“åº”
- è¿”å›æ•°æ®ï¼š
```json
{
  "status": "healthy",
  "transport": "streamable-http",
  "activeSessions": 3,
  "name": "youtube-subtitle-mcp",
  "version": "1.0.0"
}
```

### 2. âœ… MCPåè®®æµ‹è¯•

#### 2.1 Initialize æ–¹æ³•

**çŠ¶æ€**: âœ… æˆåŠŸ

- æ­£ç¡®å¤„ç† `initialize` è¯·æ±‚
- æˆåŠŸåˆ›å»ºä¼šè¯å¹¶è¿”å› Session ID
- è¿”å›æ­£ç¡®çš„åè®®ç‰ˆæœ¬ `2024-11-05`
- æ­£ç¡®è®¾ç½®å“åº”å¤´ `Mcp-Session-Id`

**å“åº”ç¤ºä¾‹**:
```json
{
  "jsonrpc": "2.0",
  "result": {
    "protocolVersion": "2024-11-05",
    "capabilities": { "tools": {} },
    "serverInfo": {
      "name": "youtube-subtitle-mcp",
      "version": "1.0.0"
    }
  },
  "id": 1
}
```

#### 2.2 Tools/List æ–¹æ³•

**çŠ¶æ€**: âœ… æˆåŠŸ

- æ­£ç¡®åˆ—å‡ºæ‰€æœ‰å¯ç”¨å·¥å…·
- å·¥å…·schemaå®Œæ•´ï¼ˆname, description, inputSchemaï¼‰
- ä¼šè¯ç®¡ç†æ­£å¸¸

**è¿”å›å·¥å…·**:
- `fetch_youtube_subtitles`: å®Œæ•´çš„å‚æ•°å®šä¹‰å’Œæè¿°

#### 2.3 Tools/Call æ–¹æ³•

**çŠ¶æ€**: âœ… æˆåŠŸ

- æ­£ç¡®è·¯ç”±å·¥å…·è°ƒç”¨
- å‚æ•°ä¼ é€’æ­£å¸¸
- é”™è¯¯å¤„ç†å®Œå–„
- è¿”å›æ ¼å¼ç¬¦åˆMCPæ ‡å‡†

---

## ğŸ“‹ ä»£ç å®ç°å¯¹æ¯”

### âœ… å®Œå…¨ç¬¦åˆæ ‡å‡†çš„éƒ¨åˆ†

| é¡¹ç›® | æ ‡å‡†è¦æ±‚ | ä½ çš„å®ç° | çŠ¶æ€ |
|------|---------|---------|------|
| **CORSé…ç½®** | å¿…é¡»é…ç½®CORS | âœ… å·²æ­£ç¡®é…ç½® | âœ… |
| **Sessionç®¡ç†** | é€šè¿‡headerç»´æŠ¤ä¼šè¯ | âœ… ä½¿ç”¨ `Mcp-Session-Id` | âœ… |
| **JSON-RPCæ ¼å¼** | ç¬¦åˆJSON-RPC 2.0 | âœ… å®Œå…¨ç¬¦åˆ | âœ… |
| **åè®®ç‰ˆæœ¬** | 2024-11-05 | âœ… æ­£ç¡® | âœ… |
| **Initializeæ–¹æ³•** | è¿”å›capabilitieså’ŒserverInfo | âœ… å®Œæ•´å®ç° | âœ… |
| **Tools/Listæ–¹æ³•** | è¿”å›å·¥å…·åˆ—è¡¨ | âœ… å®Œæ•´å®ç° | âœ… |
| **Tools/Callæ–¹æ³•** | æ‰§è¡Œå·¥å…·å¹¶è¿”å›ç»“æœ | âœ… å®Œæ•´å®ç° | âœ… |
| **é€šçŸ¥å¤„ç†** | å¿½ç•¥notifications/* | âœ… æ­£ç¡®å¤„ç†204å“åº” | âœ… |
| **é”™è¯¯å¤„ç†** | è¿”å›JSON-RPCé”™è¯¯ | âœ… å®Œæ•´å®ç° | âœ… |
| **å¥åº·æ£€æŸ¥** | æä¾›/healthç«¯ç‚¹ | âœ… å·²å®ç° | âœ… |

### âœ… ä»£ç è´¨é‡æ£€æŸ¥

#### httpServer.ts å®ç°

**ç¬¦åˆç‚¹**:
1. âœ… æ­£ç¡®å¯¼å…¥MCP SDK
2. âœ… Sessionå­˜å‚¨ç»“æ„æ¸…æ™°
3. âœ… CORSé…ç½®å®Œæ•´ï¼ˆorigin, methods, headers, exposedHeadersï¼‰
4. âœ… ä¼šè¯åˆ›å»ºå’Œç®¡ç†é€»è¾‘æ­£ç¡®
5. âœ… ä¸‰ä¸ªæ ¸å¿ƒæ–¹æ³•ï¼ˆinitialize, tools/list, tools/callï¼‰éƒ½æ­£ç¡®å®ç°
6. âœ… é€šçŸ¥æ¶ˆæ¯å¤„ç†æ­£ç¡®ï¼ˆè¿”å›204ï¼‰
7. âœ… é”™è¯¯å“åº”æ ¼å¼ç¬¦åˆJSON-RPC 2.0
8. âœ… æ—¥å¿—è¾“å‡ºå‹å¥½

#### å·¥å…·å®ç° (fetchYoutubeSubtitles.ts)

**ç¬¦åˆç‚¹**:
1. âœ… å·¥å…·ç»“æ„æ ‡å‡†ï¼ˆname, description, parameters, runï¼‰
2. âœ… å‚æ•°å®šä¹‰å®Œæ•´ï¼ˆtype, properties, requiredï¼‰
3. âœ… å‚æ•°éªŒè¯å®Œå–„
4. âœ… é”™è¯¯å¤„ç†ç»Ÿä¸€
5. âœ… è¿”å›æ ¼å¼ç¬¦åˆMCPæ ‡å‡†ï¼ˆcontentæ•°ç»„ + textç±»å‹ï¼‰
6. âœ… isErroræ ‡å¿—æ­£ç¡®ä½¿ç”¨

#### package.json é…ç½®

**ç¬¦åˆç‚¹**:
1. âœ… `"type": "module"` - ESæ¨¡å—å¯ç”¨
2. âœ… `"bin"` å­—æ®µé…ç½®æ­£ç¡®
3. âœ… `"files": ["build"]` - å‘å¸ƒé…ç½®æ­£ç¡®
4. âœ… buildè„šæœ¬åŒ…å«chmodæ“ä½œ
5. âœ… æ‰€æœ‰å¿…è¦ä¾èµ–å·²å®‰è£…
6. âœ… scriptsé…ç½®å®Œæ•´

---

## ğŸ“ å®¢æˆ·ç«¯é…ç½®æ–‡æ¡£

### âœ… stdioæ¨¡å¼é…ç½®ï¼ˆæ¨èæœ¬åœ°ä½¿ç”¨ï¼‰

ä½ çš„READMEä¸­çš„é…ç½®å®Œå…¨æ­£ç¡®ï¼š

```json
{
  "mcpServers": {
    "youtube-subtitle": {
      "command": "npx",
      "args": ["-y", "youtube-subtitle-mcp"]
    }
  }
}
```

### âœ… HTTPæ¨¡å¼é…ç½®ï¼ˆæœåŠ¡å™¨éƒ¨ç½²ï¼‰

ä½ çš„READMEä¸­çš„é…ç½®å®Œå…¨æ­£ç¡®ï¼š

```json
{
  "mcpServers": {
    "youtube-subtitle": {
      "type": "streamableHttp",
      "url": "http://localhost:3000/mcp",
      "timeout": 600
    }
  }
}
```

---

## ğŸ¯ ç»“è®º

### âœ… æ‰€æœ‰æ£€æŸ¥é¡¹ç›®éƒ½é€šè¿‡äº†ï¼

ä½ çš„é¡¹ç›®å®ç°**å®Œå…¨ç¬¦åˆ**MCP Streamable HTTPåè®®æ ‡å‡†ï¼š

1. âœ… **æœåŠ¡å™¨å¯åŠ¨æ­£å¸¸** - HTTPæœåŠ¡å™¨è¿è¡Œæ­£å¸¸
2. âœ… **åè®®å®ç°æ­£ç¡®** - æ‰€æœ‰MCPæ–¹æ³•éƒ½æ­£ç¡®å®ç°
3. âœ… **ä¼šè¯ç®¡ç†å®Œå–„** - Session IDæ­£ç¡®ä¼ é€’å’Œç»´æŠ¤
4. âœ… **CORSé…ç½®æ­£ç¡®** - å…è®¸è·¨åŸŸè®¿é—®
5. âœ… **é”™è¯¯å¤„ç†å®Œå–„** - ç¬¦åˆJSON-RPC 2.0è§„èŒƒ
6. âœ… **æ–‡æ¡£å®Œæ•´æ¸…æ™°** - READMEé…ç½®è¯´æ˜æ­£ç¡®
7. âœ… **ä»£ç ç»“æ„æ ‡å‡†** - ç¬¦åˆMCPæœ€ä½³å®è·µ

### ğŸš€ å¯ä»¥æ­£å¸¸ä½¿ç”¨çš„åœºæ™¯

ä½ çš„é¡¹ç›®ç°åœ¨å¯ä»¥ï¼š

âœ… é€šè¿‡ `npx youtube-subtitle-mcp` æœ¬åœ°ä½¿ç”¨ï¼ˆstdioæ¨¡å¼ï¼‰  
âœ… é€šè¿‡ HTTP æœåŠ¡å™¨è¿œç¨‹ä½¿ç”¨ï¼ˆHTTPæ¨¡å¼ï¼‰  
âœ… åœ¨ Claude Desktop ä¸­é…ç½®ä½¿ç”¨  
âœ… Docker éƒ¨ç½²  
âœ… å‘å¸ƒåˆ° npm  

---

## ğŸ’¡ å¯é€‰ä¼˜åŒ–å»ºè®®ï¼ˆéå¿…éœ€ï¼‰

è™½ç„¶ä½ çš„å®ç°å·²ç»å®Œå…¨æ­£ç¡®ï¼Œä½†å¦‚æœæƒ³è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œå¯ä»¥è€ƒè™‘ï¼š

### 1. æ·»åŠ ä¼šè¯æ¸…ç†æœºåˆ¶

```typescript
// æ¸…ç†è¶…è¿‡30åˆ†é’Ÿä¸æ´»è·ƒçš„ä¼šè¯
setInterval(() => {
  const now = new Date();
  for (const [id, session] of sessions.entries()) {
    const inactive = now.getTime() - session.lastActivity.getTime();
    if (inactive > 30 * 60 * 1000) {
      sessions.delete(id);
    }
  }
}, 5 * 60 * 1000); // æ¯5åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
```

### 2. æ·»åŠ è¯·æ±‚æ—¥å¿—ï¼ˆå¯é€‰ï¼‰

```typescript
app.use((req, res, next) => {
  console.log(`[${new Date().toISOString()}] ${req.method} ${req.path}`);
  next();
});
```

### 3. æ·»åŠ é€Ÿç‡é™åˆ¶ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

```typescript
import rateLimit from 'express-rate-limit';

const limiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15åˆ†é’Ÿ
  max: 100 // é™åˆ¶100ä¸ªè¯·æ±‚
});

app.use('/mcp', limiter);
```

ä½†è¿™äº›éƒ½æ˜¯**å¯é€‰çš„**ï¼Œä½ å½“å‰çš„å®ç°å·²ç»å®Œå…¨å¯ç”¨ï¼

---

## ğŸ“ æ”¯æŒ

å¦‚æœä½ åœ¨å®é™…ä½¿ç”¨ä¸­é‡åˆ°ä»»ä½•é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š

1. æœåŠ¡å™¨æ˜¯å¦æ­£å¸¸è¿è¡Œï¼ˆè®¿é—® http://localhost:3000/healthï¼‰
2. é˜²ç«å¢™æ˜¯å¦å…è®¸ç«¯å£3000
3. Claude Desktopé…ç½®æ–‡ä»¶æ ¼å¼æ˜¯å¦æ­£ç¡®
4. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸

**ä½ çš„å®ç°æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼å¯ä»¥æ”¾å¿ƒä½¿ç”¨ã€‚** ğŸ‰

